This file is a merged representation of the entire codebase, combined into a single document by Repomix.

<file_summary>
This section contains a summary of this file.

<purpose>
This file contains a packed representation of the entire repository's contents.
It is designed to be easily consumable by AI systems for analysis, code review,
or other automated processes.
</purpose>

<file_format>
The content is organized as follows:
1. This summary section
2. Repository information
3. Directory structure
4. Repository files (if enabled)
5. Multiple file entries, each consisting of:
  - File path as an attribute
  - Full contents of the file
</file_format>

<usage_guidelines>
- This file should be treated as read-only. Any changes should be made to the
  original repository files, not this packed version.
- When processing this file, use the file path to distinguish
  between different files in the repository.
- Be aware that this file may contain sensitive information. Handle it with
  the same level of security as you would the original repository.
</usage_guidelines>

<notes>
- Some files may have been excluded based on .gitignore rules and Repomix's configuration
- Binary files are not included in this packed representation. Please refer to the Repository Structure section for a complete list of file paths, including binary files
- Files matching patterns in .gitignore are excluded
- Files matching default ignore patterns are excluded
- Files are sorted by Git change count (files with more changes are at the bottom)
</notes>

</file_summary>

<directory_structure>
config/
  db.js
controller/
  authController.js
middleware/
  authMiddleware.js
models/
  Expense.js
  Income.js
  User.js
routes/
  authRoute.js
  dashboardRoute.js
  expenseRoute.js
  incomeRoute.js
.gitignore
package.json
README.md
server.js
</directory_structure>

<files>
This section contains the contents of the repository's files.

<file path="config/db.js">
const mongoose = require("mongoose");

const connectDB = async () => {
  try {
    await mongoose.connect(process.env.MONGO_URI, {});
    console.log("MongoDB Connected");
  } catch (err) {
    console.error("Error connecting to MongoDB", err);
    process.exit(1);
  }
};

module.exports = connectDB;
</file>

<file path="controller/authController.js">
const User = require("../models/User");
const jwt = require("jsonwebtoken");

// Generate JWT Token
const generateToken = (id) => {
  return jwt.sign({ id }, process.env.JWT_SECRET, { expiresIn: "1h" });
};

// Register User
exports.registerUser = async (req, res, next) => {
  const { fullName, email, password, profileImageUrl } = req.body;

  // Validation Check for Missing fields
  if (!fullName || !email || !password) {
    return res.status(400).json({ message: "All fields are required" });
  }

  try {
    // Check if email already exists
    const existingUser = await User.findOne({ email });
    if (existingUser) {
      return res.status(400).json({ message: "Email already in use" });
    }

    // Create the User
    const user = User.create({
      fullName,
      email,
      password,
      profileImageUrl,
    });

    res.status(401).json({
      id: user._id,
      user,
      token: generateToken(user._id),
    });
  } catch (err) {
    res
      .status(500)
      .json({ mesage: "Error registering user", error: err.message });
  }
};

// Login User
exports.loginUser = async (req, res, next) => {};

// Get User Info
exports.getUserInfo = async (req, res, next) => {};
</file>

<file path="models/User.js">
const mongoose = require("mongoose");
const bcrypt = require("bcryptjs");

const UserSchema = new mongoose.Schema(
  {
    fullName: { type: String, required: true },
    email: { type: String, required: true, unique: true },
    password: { type: String, required: true },
    profileImageUrl: { type: String, default: null },
  },
  {
    timestamps: true,
  }
);

// hash password before saving
UserSchema.pre("save", async function (next) {
  if (!this.isModified("password")) return next();
  this.password = await bcrypt.hash(this.password, 10);
  next();
});

// compare passwords
UserSchema.methods.comparePassword = async function (candidatePassword) {
  return await bcrypt.compare(candidatePassword, this.password);
};

module.exports = mongoose.model("User", UserSchema);
</file>

<file path="routes/authRoute.js">
const express = require("express");

const {
  registerUser,
  loginUser,
  getUserInfo,
} = require("../controller/authController");

const router = express.Router();

router.post("/register", registerUser);
router.post("/login", loginUser);
router.get("/getUser", getUserInfo);

module.exports = router;
</file>

<file path=".gitignore">
node_modules
.DS_Store
.env
</file>

<file path="package.json">
{
  "name": "spender-backend",
  "version": "1.0.0",
  "description": "",
  "main": "server.js",
  "scripts": {
    "start": "node server.js",
    "dev": "nodemon server.js"
  },
  "keywords": [],
  "author": "",
  "license": "ISC",
  "dependencies": {
    "bcryptjs": "^3.0.2",
    "cors": "^2.8.5",
    "dotenv": "^17.2.3",
    "express": "^5.1.0",
    "jsonwebtoken": "^9.0.2",
    "mongoose": "^8.19.1",
    "multer": "^2.0.2",
    "xlsx": "^0.18.5"
  },
  "devDependencies": {
    "nodemon": "^3.1.10"
  }
}
</file>

<file path="README.md">
## STEPS

- run npm init -y to create package.json file change it's name to spender-backend and then create a server.js file

- run npm install express jsonwebtoken mongoose dotenv cors bcryptjs multer xlsx

- create a http server in express and run it on port 8000 create a .env file and add PORT as 8000 and fallback as 5000

- import dotenv, express, cors and path and then add a middleware to handle cors and then a middlware to parse json

- import connectDB function from config/db and connect the mongo database, create a mongo connection going to atlas add the MONGO_URI in .env

- write the authentication route and import it in server.js from route/authRoute and start the server on the specified PORT in .env

- node -e "console.log(require('crypto').randomBytes(64).toString('hex'))" to create a JWT_SECRET and add it in the .env

- create config(inside db.js), controller(inside authController.js), middleware(authMiddleware.js), models(Expense.js, Income.js, User.js), routes(authRoute.js, dashboardRoute.js, expenseRoute.js, incomeRoute.js) and uploads folder

- in the db.js file import the mongoose library and define the async connectDB function with try and catch block and export the module and import it in the server.js file

- in the User.js file import mongoose and define the UserSchema function that defines the schema for the Users mainly fullName, email, Password, ProfileImage and add Timestamps

- write a function to hash the password before saving in User.js then write the function to compare the hashed and the entered password to check matching during login

- in the authController.js file import jsonwebtoke as jwt and write generateToken function that creates a jwt token for a session that expires in 1 hour, then write the async functions for registerUser, loginUser and getUserInfo and export those functions.

- in the authRoute.js import these registerUser, loginUser and getUserInfo functions from authController.js and use express router to register and login user via post method and get method to get the user info at /register, /login, and /getUser

- then start writing the logic for registerUser, first destructure the object for the req.body then do the validation check for missing fields then in a try catch block implement the logic for if the email already exists if it exists return email is already in use else register the user and generate a user id, and in the catch block return the status 500 with error message
</file>

<file path="server.js">
require("dotenv").config();
const express = require("express");
const cors = require("cors");
const path = require("path");
const connectDB = require("./config/db");
const authRoutes = require("./routes/authRoute");

const app = express();

// Middleware to Handle CORS
app.use(
  cors({
    origin: process.env.CLIENT_URL || "*",
    methods: ["GET", "POST", "PUT", "DELETE"],
    allowedHeaders: ["Content-Type", "Authorization"],
  })
);

// Middleware to parse JSON
app.use(express.json());

// MongoDB Connection
connectDB();

// Authentication Route
app.use("api/v1/auth", authRoutes);

// Server Start
const PORT = process.env.PORT || 5000;
app.listen(PORT, () => console.log(`Server is running on PORT ${PORT}`));
</file>

</files>
